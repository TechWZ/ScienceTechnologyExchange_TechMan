<script>
    function addLevelTwoInput() {
        let dynamicHtml =
            "<div class='row' id='row" + Date.now() + "'>" +
            "<div class='col-10'>" +
            "<input type='text' class='form-control' placeholder='二级系统分类' name='levelTwoNameList'>" +
            "</div>" +
            "<div class='col-2 text-right'>" +
            "<button type='button' class='btn btn-outline-danger' onclick=\"subLevelTwoInput('row" + Date.now() + "')\">" +
            "<i class='fa fa-minus-circle'></i>" +
            "</button>" +
            "</div>" +
            "</div>";

        $("#levelTwo_formGroup").append(dynamicHtml);
    }
    function subLevelTwoInput(divId) {
        $("#" + divId).remove();
    }

    function confirmAdd() {
        let parameter = $("#systemCategoryForm").serializeObject();
        $.ajax({
            type: "post",
            contentType:"application/json",
            dataType:"json",
            data: JSON.stringify(parameter),
            url: "http://127.0.0.1:8080/STE/addManagementCategory",
            success: function (result) {
                $("button[data-dismiss=modal]").trigger("click");
                alert("添加完成");
            }
        });
    }

    function editManagementSystemCategory(mCategoryId){
        $.ajax({
            type:"get",
            contentType:"application/json",
            dataType:"json",
            data: {
                "id":mCategoryId
            },
            url:"http://127.0.0.1:8080/STE/getManagementSystemCategoryById",
            success:function(result){
                let getManagementSystemCategoryById={
                    "getManagementSystemCategoryById":result
                }
                let dataHtml = Handlebars.templates.systemCategory_m_index(getManagementSystemCategoryById);
                $("#v-pills-tabContent").html(dataHtml);
            }
        });
    }
</script>
<div class="row">
    <div class="col-12">
        <div class="row">
            <div class="col-6">
                <button type="button" class="btn btn-outline-success" data-toggle="modal" data-target="#managementSystemCategoryModal"><i
                        class="fa fa-plus"></i></button>
            </div>
            <div class="col-6 text-right">
                <button type="button" class="btn btn-outline-danger"><i class="fa fa-trash"></i></button>
            </div>
        </div>

        <table class="table table-bordered">
            <thead>
                <tr>
                    <th scope="col">序号</th>
                    <th scope="col">一级分类名称</th>
                    <th scope="col">操作</th>
                </tr>
            </thead>
            <tbody>
                {{#if managementNavigation}}
                {{#each managementNavigation}}
                <tr>
                    <th scope="row">{{@index}}</th>
                    <td>{{mLevelOneName}}</td>
                    <td>
                        <button type="button" class="btn btn-outline-warning" data-toggle="modal" data-target="#managementSystemCategoryModal" onclick="editManagementSystemCategory('{{mCategoryId}}')"><i class="fa fa-wrench"></i></button>
                    </td>
                </tr>
                {{/each}}
                {{/ if}}
            </tbody>
        </table>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="managementSystemCategoryModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">{{#if getManagementSystemCategoryById}}编辑{{/ if}}添加1系统分类</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="systemCategoryForm">
                    <div class="form-group">
                        <label for="exampleInputEmail1">一级系统分类</label>
                        <input type="text" class="form-control" id="exampleInputEmail1" placeholder="一级系统分类"
                            name="levelOneName" value="{{mLevelOneName}}">
                    </div>
                    <div class="form-group" id="levelTwo_formGroup">
                        <div class="row">
                            <div class="col-6"><label>二级系统分类</label></div>
                            <div class="col-6 text-right">
                                <button class="btn btn-outline-success" onclick="addLevelTwoInput()" type="button">
                                    <i class="fa fa-plus-circle"></i>
                                </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-10">
                                <input type="text" class="form-control" placeholder="二级系统分类" name="levelTwoNameList">
                            </div>
                            <div class="col-2 text-right">

                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-outline-success" onclick="confirmAdd()">确认添加</button>
            </div>
        </div>
    </div>
</div>